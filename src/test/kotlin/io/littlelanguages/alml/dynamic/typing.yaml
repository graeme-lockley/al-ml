- name: Identity
  input: |
    let identity x = x;
    let someValue = identity 10
  output:
    program:
      values:
        - someValue
      procedures:
        - procedure:
            name: identity
            parameters: [ x ]
            depth: 0
            offsets: 1
            es:
              - parameter:
                  name: x
                  depth: 0
                  offset: 0
        - procedure:
            name: _main
            parameters: [ ]
            depth: 0
            offsets: 0
            es:
              - assign:
                  symbol:
                    toplevel-value: someValue
                  es:
                    - call-procedure:
                        procedure:
                          declared-procedure:
                            name: identity
                            parameter-count: 1
                            depth: 0
                        es:
                          - - 10
                        line-number: 2
- name: call procedure
  input: |
    let add b = \c -> b + c;
    (add 10) 20
  constraints: [ ]
- name: signal expression
  input: |
    signal "DivideByZero"
  constraints:
    - String ~ String
- scenario:
    name: if
    tests:
      - name: with else
        input: |
          if (1) -> "hello" else "world"
        constraints:
          - S32 ~ Bool
          - String ~ String
      - name: without else
        input: |
          if (1) -> "hello"
        constraints:
          - S32 ~ Bool
- name: reference top-level value
  input: |
    let name = "Hello";
    if name -> name
  constraints:
    - "'0 ~ Bool"